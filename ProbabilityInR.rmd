---
title: "Prawdopodobienstwo w R"
author: "Marcin Mika"
date: "2023-01-16"
output: html_document
---

# Zadania - czÄ™Å›Ä‡ I

## Zadanie 6(15)

Niech zmienna losowa ğ‘‹ ma rozkÅ‚ad ğ‘(0,1). ObliczyÄ‡ ğ‘ƒ(|ğ‘‹| < 1,5).
```{r}
p_X <- pnorm(1.5) - (1 - pnorm(1.5))
p_X
```
PrawdpopodobieÅ„stwo, Å¼e wartoÅ›Ä‡ bezwzglÄ™dna ze zmiennej losowej X o rozkÅ‚adzie normalnym N(0,1) jest mniejsza od 1,5 wynosi ok. 87%. 

Aby obliczyÄ‡ to prawdopodobieÅ„stwo skorzystaliÅ›my z funkcji pnorm, ktÃ³ra jest funkcjÄ… dystrybunanty rozkÅ‚adu normlanego. 

## Zadanie 6(1)

Liczba awarii pewnej maszyny w ciÄ…gu miesiÄ…ca ma rozkÅ‚ad Poissona z parametrem ğœ† = 2. 
ObliczyÄ‡ prawdopodobieÅ„stwo wystÄ…pienia w ciÄ…gu miesiÄ…ca:
<br/>
<br/>
a) mniej niÅ¼ 4 awarii 
```{r}
pa <- ppois(3, lambda = 2, lower.tail = TRUE)
pa
```
PrawdpopodobieÅ„stwo, Å¼e liczba awari bÄ™dzie mniejsza od 4 wynosi ok. 86%.
<br/>
<br/>
b) mniej niÅ¼ 2 awarii 
```{r}
pb <- ppois(1, lambda = 2, lower.tail = TRUE)
pb
```
PrawdpopodobieÅ„stwo, Å¼e liczba awari bÄ™dzie mniejsza od 2 wynosi ok. 41%.
<br/>
<br/>
c) wiÄ™cej niÅ¼ 1 awarii 
```{r}
pc <- 1 - ppois(1, lambda = 2, lower.tail = TRUE)
pc
```
PrawdpopodobieÅ„stwo, Å¼e liczba awari bÄ™dzie wiÄ™ksza od 1 wynosi ok. 59%.
<br/>
<br/>
d) 9 lub 10 awarii
```{r}
p9 <- dpois(9, lambda = 2)
p10 <- dpois(10, lambda = 2)
pd <- p9 + p10
pd
```
PrawdpopodobieÅ„stwo, Å¼e liczba awari bÄ™dzie rÃ³wna 9 lub dziesiÄ™Ä‡ wynosi ok. 0,02%.
<br/>
<br/>
Do obliczeÅ„ skorzystaliÅ›my z funkcji ppois, ktÃ³ra oblicza wartoÅ›Ä‡ funkcji gÄ™stoÅ›ci prawdopodobieÅ„stwa (PDF) dla rozkÅ‚adu Poissona dla danego argumentu. Argumentem jest liczba sukcesÃ³w, a parametrem jest oczekiwana liczba sukcesÃ³w. Funkcja ta pozwala na obliczenie prawdopodobieÅ„stwa, Å¼e liczba sukcesÃ³w jest rÃ³wna danej liczbie lub mniejsza od niej.

# Zadania - czeÅ›Ä‡ II

## Zadanie 6 

Åšrednio co 20 pasaÅ¼er wsiadajÄ…cy do autobusu na pewnym przystanku kupuje bilet 
w automacie. WiedzÄ…c, Å¼e dziennie z tego przystanku odjeÅ¼dÅ¼a 700 osÃ³b obliczyÄ‡ jakie jest 
prawdopodobieÅ„stwo, Å¼e kaseta zaÅ‚adowanego do automatu biletowego zawierajÄ…ca 
1000 biletÃ³w wystarczy na co najmniej 4 tygodnie?
<br/>

### Twierdzenie de Moivre'a-Laplace'a
```{r}
p <- 0.05
q <- 0.95
n <- 4 * 7 * 700
# Obliczanie prawdopodobieÅ„stwa, Å¼e liczba "sukcesÃ³w" jest mniejsza niÅ¼ 1000
pML <- pbinom(1000, size = n, prob = p, lower.tail = TRUE)
pML
```
PrawdpopodobieÅ„stwo, Å¼e 1000 wystarczy na co najmniej 4 tygodnie wynosi ok. 75%
<br/>
<br/>
Aby obliczyÄ‡ prawdopodobieÅ„stwo, Å¼e liczba sukcesÃ³w (X) w serii 19600 prÃ³b z prawdopodobieÅ„stwem sukcesu p = 0.05 i prawdopodobieÅ„stwem niepowodzenia q = 0.95 jest mniejsza niÅ¼ 1000, moÅ¼emy skorzystaÄ‡ z funkcji "pbinom" w R. WyÅ›wietli on wartoÅ›Ä‡ prawdopodobieÅ„stwa, Å¼e liczba sukcesÃ³w (X) jest mniejsza niÅ¼ 1000 dla serii 19600 prÃ³b z prawdopodobieÅ„stwem sukcesu p = 0.05 i prawdopodobieÅ„stwem niepowodzenia q = 0.95.

### Metoda Monte Carlo
```{r}
# symulacja prÃ³b
X <- rbinom(10^6, size=n, prob=p)

# liczenie iloÅ›ci prÃ³b gdzie liczba sukcesÃ³w jest mniejsza niÅ¼ 1000
Xsum <- sum(X < 1000)

# prawdopodobieÅ„stwo
pMC <- Xsum / length(X)
pMC
```
PrawdopodobieÅ„stwo obliczone przy pomocy metody Monte Carlo to ok. 74%
<br/>
<br/>
Aby obliczyÄ‡ prawdopodobieÅ„stwo, Å¼e liczba sukcesÃ³w (X) w serii 19600 prÃ³b z prawdopodobieÅ„stwem sukcesu p = 0.05 jest mniejsza niÅ¼ 1000, moÅ¼emy skorzystaÄ‡ z symulacji Monte Carlo w R. Funkcja rbinom(n,size,prob) generuje n losowych liczb z rozkÅ‚adu binomialnego. W tym przypadku generuje 10^6 liczb z rozkÅ‚adu binomialnego o n = 19600 prÃ³bach i p = 0.05. NastÄ™pnie sumujemy te liczby ktÃ³re sÄ… mniejsze niÅ¼ 1000 i dzielimy je przez liczbÄ™ wygenerowanych liczb, daje to prawdopodobieÅ„stwo.

## Zadanie 26

DÅ‚ugoÅ›Ä‡ autostrady budowanej przez pewnÄ… firmÄ™ w ciÄ…gu jednego dnia jest zmiennÄ… 
losowÄ… o wartoÅ›ci oczekiwanej 0,8km i odchyleniu stand. 1km. Jakie jest 
prawdopodobieÅ„stwo, Å¼e w ciÄ…gu 90 dni firma ta wybuduje co najmniej 75 km 
autostrady?

### Centralne twierdzenie graniczne â€“ twierdzenie Lindeberga â€“ Levyâ€™ego
```{r}
n <- 90
m <- 0.8*n
s <- sqrt(n)
1 - pnorm(75, mean=m, sd=s)
```
PrawdpopodobieÅ„stwo, Å¼e firma wybuduje w ciÄ…gu 90 dni co najmniej 75 km autostrady wynosi ok. 38%
<br/>
<br/>
Aby obliczyÄ‡ to prawdopodobieÅ„stwo, naleÅ¼y uÅ¼yÄ‡ funkcji pnorm() w R. DÅ‚ugoÅ›Ä‡ autostrady budowanej przez firmÄ™ w ciÄ…gu 90 dni jest sumÄ… 90 losowych zmiennych, ktÃ³re majÄ… wartoÅ›Ä‡ oczekiwanÄ… 0,8km i odchylenie standardowe 1km. Suma takich zmiennych jest rozkÅ‚adem normalnym o wartoÅ›ci oczekiwanej 90 * 0.8 = 72km i odchyleniu standardowym sqrt(90)*1=9,5km. Aby obliczyÄ‡ prawdopodobieÅ„stwo, Å¼e dÅ‚ugoÅ›Ä‡ autostrady jest co najmniej 75 km, naleÅ¼y obliczyÄ‡ P(X >= 75), gdzie X jest zmiennÄ… losowÄ… opisanÄ… powyÅ¼ej

### Metoda Monte Carlo 
```{r}
N <- 100000 # liczba symulacji
count <- 0 # licznik sum wiÄ™kszych od 75km

for (i in 1:N) {
  daily_lengths <- rnorm(90, mean = 0.8, sd = 1)
  total_length <- sum(daily_lengths)
  if (total_length >= 75) {
    count <- count + 1
  }
}

prob <- count / N
prob
```
PrawdopodobieÅ„stwo uÅ¼yte przy pomocy metody Monte Carlo to ok. 38%

# Zadania - czÄ™Å›Ä‡ III

## Zadanie 10 (Test dla jednej wartoÅ›ci Å›redniej)

Norma przewiduje, Å¼e na kotlet na stoÅ‚Ã³wce studenckiej powinien waÅ¼yÄ‡ 120 g . W celu 
zbadania, czy rzeczywiÅ›cie tak jest zwaÅ¼ono 30 wydawanych kotletÃ³w. Uzyskano 
nastÄ™pujÄ…ce rezultaty: Å›rednia waga kotleta: 115g, odchylenie standardowe = 30g. Na 
poziomie istotnoÅ›ci ğ›¼ = 0,05 zweryfikowaÄ‡ hipotezÄ™ o zgodnoÅ›ci wagi wydawanych 
kotletÃ³w, gdy hipotezÄ… alternatywnÄ… jest, Å¼e podawane studentom kotlety waÅ¼Ä… mniej niÅ¼ 
przewiduje norma. 

```{r}
pv <- stat <- c()
for (i in 1:10000){
torebki<-rnorm(30, mean=115, sd = 30 )
(test <- t.test(torebki, mu=120, alternative="less"))
pv[i] = test$p.value
stat[i] = test$statistic
}
sum(pv<0.05)/10000
```
WartoÅ›Ä‡ Alfa jest mniejsza od p-value, co oznacza, Å¼e nie ma podstaw do odrzucenia hiptezy H0, tj. przewidywana norma dot. wagi kotletÃ³w na poziomie istotnoÅ›ci Alfa = 0.05 jest odpowiednia 
<br/>
<br/>
Ten kod tworzy pÄ™tlÄ™, ktÃ³ra jest wykonywana 10000 razy. W kaÅ¼dej iteracji pÄ™tli tworzona jest nowa prÃ³bka losowych liczb z rozkÅ‚adu normalnego o Å›redniej 115 i odchyleniu standardowym 30.
NastÄ™pnie, prÃ³bka jest testowana przeciwko hipotezie zerowej, Å¼e Å›rednia jest rÃ³wna 120, przy uÅ¼yciu testu t-Studenta dla jednej prÃ³by z hipotezÄ… alternatywnÄ…, Å¼e Å›rednia jest mniejsza niÅ¼ 120.
Wynik testu (zawierajÄ…cy statystykÄ™ testowÄ… i p-value) jest zapisywany w zmiennej "test".
NastÄ™pnie wartoÅ›Ä‡ p-value jest zapisywana w tablicy "pv", a statystyka testowa jest zapisywana w tablicy "stat"
Po zakoÅ„czeniu pÄ™tli, kod liczy liczbÄ™ iteracji, w ktÃ³rych p-value jest mniejsze niÅ¼ 0.05:
sum(pv<0.05)
Ten kod jest przykÅ‚adem symulacji p-hackingu, ktÃ³ry polega na manipulowaniu danymi lub metodami statystycznymi, aby uzyskaÄ‡ statystycznie istotne wyniki, bez odpowiedniej analizy.

## Zadanie 13 (Test dla dwÃ³ch wartoÅ›ci Å›rednich)

25 osobowa grupa wylosowana spoÅ›rÃ³d zdajÄ…cych egzamin z RPiSM w poprzednim roku 
uzyskaÅ‚a w I terminie Å›redniÄ… liczbÄ™ punktÃ³w 26,7 przy odchyleniu stand. 8,7. 27 osobowa 
grupa wylosowana spoÅ›rÃ³d zdajÄ…cych egzamin z RPiSM w zeszÅ‚ym roku uzyskaÅ‚a w II 
terminie Å›redniÄ… liczbÄ™ punktÃ³w 25,3 przy odchyleniu stand. 9,5. Czy na tej podstawie 
moÅ¼na stwierdziÄ‡, Å¼e wartoÅ›Ä‡ oczekiwana liczby punktÃ³w z kolejnych terminÃ³w egzaminu 
z RPiSM nie rÃ³Å¼ni siÄ™ istotnie? Jakie zaÅ‚oÅ¼enia naleÅ¼y przyjÄ…Ä‡ w tym teÅ›cie? 
```{r}
pv <- stat <- c()
for (i in 1:10000){
  term_1 <- c(rnorm(25, mean = 26.7, sd = 8.7))
  term_2 <- c(rnorm(27, mean = 25.3, sd = 9.5))
  t_test <- t.test(term_1, term_2, alternative = "two.sided", var.equal = TRUE, conf.level = 0.95)
  pv[i] = t_test$p.value
  stat[i] = t_test$statistic
}
sum(pv<0.05)/10000
 
```
Rnorm(25, mean = 26.7, sd = 8.7) to wektor zawierajÄ…cy losowo wygenerowane wartoÅ›ci z pierwszego terminu zgodnie z podanymi parametrami, rnorm(27, mean = 25.3, sd = 9.5) to wektor zawierajÄ…cy losowo wygenerowane wartoÅ›ci z drugiego terminu zgodnie z podanymi parametrami, alternative = "two.sided" oznacza, Å¼e jest to test dwustronny.
WartoÅ›Ä‡ p-wartoÅ›ci pomoÅ¼e stwierdziÄ‡, czy rÃ³Å¼nica miÄ™dzy Å›rednimi liczbÄ… punktÃ³w z kolejnych terminÃ³w egzaminu z RPiSM jest istotna statystycznie. JeÅ›li wartoÅ›Ä‡ p-wartoÅ›ci jest mniejsza niÅ¼ poziom istotnoÅ›ci (np. 0.05), to moÅ¼na odrzuciÄ‡ hipotezÄ™ zerowÄ… i stwierdziÄ‡, Å¼e wartoÅ›Ä‡ oczekiwana liczby punktÃ³w z kolejnych terminÃ³w egzaminu z RPiSM rÃ³Å¼ni siÄ™ istotnie.
<br/>
<br/>
wartoÅ›Ä‡ Alfa = 0.05 jest wiÄ™ksza od p-value, co oznacza, Å¼e nie ma przesÅ‚anek aby odrzuciÄ‡ hipotezÄ™ 0 

## Zadanie 29 (Test dla jednej frakcji)

W trakcie badania skutecznoÅ›ci dziaÅ‚ania pewnej pasty do zÄ™bÃ³w 103 spoÅ›rÃ³d 130 
dentystÃ³w biorÄ…cych w nim udziaÅ‚ wyraziÅ‚o swoje pozytywne opinie. Czy na tej podstawie 
moÅ¼na twierdziÄ‡, Å¼e tÄ™ pastÄ™ poleca ponad 3/4 dentystÃ³w w Polsce?
```{r}
# Dane
rozwiazanie_problemu <- 103
grupa <- 130
prawdopodobienstwo <- 0.75

# Test proporcji
result <- prop.test(rozwiazanie_problemu, grupa, alternative = "greater", p = prawdopodobienstwo)
result$p.value
```
Nie moÅ¼na twierdziÄ‡, Å¼e tÄ™ pastÄ™ poleca ponad 3/4 dentystÃ³w w Polsce na podstawie badania skutecznoÅ›ci dziaÅ‚ania, ktÃ³rego uczestniczyÅ‚o jedynie 103 spoÅ›rÃ³d 130 dentystÃ³w biorÄ…cych w nim udziaÅ‚. Aby to stwierdziÄ‡, konieczne byÅ‚oby przeprowadzenie badania na wiÄ™kszej prÃ³bie dentystÃ³w, reprezentatywnej dla caÅ‚ego kraju.

103 to liczba sukcesÃ³w (pozytywnych opinii), 130 to liczba prÃ³b (wszystkich dentystÃ³w biorÄ…cych udziaÅ‚ w badaniu), p = 0.75 to hipotetyczna proporcja sukcesÃ³w w populacji (3/4 dentystÃ³w polecajÄ…cych pastÄ™), a alternative = "greater" oznacza, Å¼e jest to test jednostronny na rzecz alternatywy, Å¼e proporcja sukcesÃ³w jest wiÄ™ksza niÅ¼ 0.75.

## Zadanie 47 (Test dla dwÃ³ch frakcji)

Tylko 90 spoÅ›rÃ³d 130 ankietowanych wyraziÅ‚o pozytywnÄ… opiniÄ™ o jakoÅ›ci obsÅ‚ugi 
w oddziaÅ‚ach pewnego banku. Te wyniki skÅ‚oniÅ‚y dyrekcjÄ™ do przeprowadzenia serii 
szkoleÅ„ majÄ…cych na celu poprawÄ™ jakoÅ›ci obsÅ‚ugi. Po pewnym czasie znÃ³w 
przeprowadzono ankietÄ™ wÅ›rÃ³d klientÃ³w. Tym razem pozytywnÄ… opiniÄ™ wyraziÅ‚o 230 
spoÅ›rÃ³d 340 ankietowanych. Czy na tej podstawie moÅ¼na stwierdziÄ‡, Å¼e przeprowadzone 
szkolenia przyczyniÅ‚y siÄ™ do istotnego poprawienia jakoÅ›ci obsÅ‚ugi w banku?
```{r}
prop.test(c(90, 230), c(130, 340), alternative = "less")
```
P-value (0.5866) > alfa = 0.05. Nie ma podstaw do odrzucenia hipotezy H0, zatem nie moÅ¼na stiwerdziÄ‡, Å¼e przeprowadzone szkolenia przyczyniÅ‚y siÄ™ do istotnego poprawienia jakoÅ›ci obsÅ‚ugi w badanym banku.

# Zadania - czeÅ›Ä‡ IV

## Zadanie 4 (Test zgodnoÅ›ci)
Z populacji pobrano 1000-elementowÄ… prÃ³bkÄ™ i wyniki jej badania ze wzglÄ™du na pewnÄ… 
cechÄ™ zebrano w tabeli:
<center>
<br/>
![](tabela_zad4.png){ width=600px}
<br/>
<br/>
Na poziomie istotnoÅ›ci 0,05 za pomocÄ… testu chi-kwadrat zweryfikowaÄ‡ hipotezÄ™, Å¼e badana cecha ma rozkÅ‚ad normalny.

```{r}
observed = c(2, 273, 280, 292, 110, 34, 7, 2)
chisq.test(observed, p=c(0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1), 
            rescale.p = TRUE, simulate.p.value=TRUE, B=1000)
```
Funkcja ta zwrÃ³ci informacje o testowanej hipotezie, wartoÅ›ci p oraz statystyce chi-kwadrat. JeÅ›li p-value jest mniejsze niÅ¼ poziom istotnoÅ›ci (0.01), oznacza to, Å¼e nie moÅ¼na odrzuciÄ‡ hipotezy zerowej, Å¼e rozkÅ‚ad badanej cechy jest normalny.
W tym przypadku, p=c(0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1) oznacza, Å¼e dla kaÅ¼dego przedziaÅ‚u (0-1, 1-2, 2-3, itd.) przyjmuje siÄ™, Å¼e teoretycznie oczekiwana licznoÅ›Ä‡ wynosi 10% caÅ‚kowitej licznoÅ›ci prÃ³by (1000 elementÃ³w).
To znaczy, dla kaÅ¼dego z przedziaÅ‚Ã³w oczekiwana licznoÅ›Ä‡ wynosi 0.1*1000 = 100.
Funkcja chisq.test porÃ³wnuje otrzymane licznoÅ›ci z oczekiwanymi licznoÅ›ciami i sprawdza czy rÃ³Å¼nice sÄ… istotne statystycznie.
<br/>
<br/>
P-value(0.000999) jest mniejsze od poziomu istotnoÅ›ci(0.01), zatem nie moÅ¼emy odrzuciÄ‡ hipotezy zerowej, Å¼e badana cech ma rozkÅ‚ad normalny.

## Zadanie 12 (niezaleÅ¼noÅ›Ä‡ cech)

Na podstawie 32-elementowej prÃ³by obliczono, Å¼e wspÃ³Å‚czynnik korelacji pomiÄ™dzy 
przekÄ…tnÄ… ekranu a cenÄ… laptopa wynosi 0,65. Czy na tej podstawie moÅ¼na tÄ™ zaleÅ¼noÅ›Ä‡ 
uznaÄ‡ za istotnÄ… na poziomie istotnoÅ›ci 0,05?

```{r}
set.seed(4)
count <- 0
for(i in 1:10000){
  x <- rnorm(32, mean = 14, sd = 2) # generowanie danych dotyczÄ…cych przekÄ…tnej ekranu
  y <- rnorm(32, mean = 1000, sd = 200) # generowanie danych dotyczÄ…cych ceny laptopa
  correlation <- cor.test(x, y, method = "pearson") # test korelacji Pearsona
  p <- correlation$p.value # p-value
  if (p < 0.05) count <- count + 1
}
count/10000
```
W tym przykÅ‚adzie wygenerowano 32 elementowÄ… prÃ³bÄ™ danych przy uÅ¼yciu rnorm dla przekÄ…tnej ekranu oraz dla ceny laptopa. NastÄ™pnie zwiÄ™kszyliÅ›my cenÄ™ laptopa o 0,65 razy przekÄ…tnÄ… ekranu, co pozwala na utworzenie zaleÅ¼noÅ›ci z korelacjÄ… 0,65.
Funkcja cor.test() jest uÅ¼ywana do przeprowadzenia testu korelacji Pearsona i wartoÅ›ci p-value jest porÃ³wnywana z poziomem istotnoÅ›ci 0,05. JeÅ›li wartoÅ›Ä‡ p jest mniejsza niÅ¼ poziom istotnoÅ›ci, moÅ¼na odrzuciÄ‡ hipotezÄ™ zerowÄ… i stwierdziÄ‡, Å¼e zaleÅ¼noÅ›Ä‡ jest istotna. W przeciwnym razie nie moÅ¼na stwierdziÄ‡, Å¼e zaleÅ¼noÅ›Ä‡ jest istotna..
<br/>
W naszym przypadku p-value = 0.0494 > Alfa = 0.05, co oznacza, Å¼e nie moÅ¼emy stierdziÄ‡, Å¼e zaleÅ¼noÅ›Ä‡ jest istotna 

